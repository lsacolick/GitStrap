
var gs_blog_keyword='GSBLOG';var gs_post_path='posts';var gs_error_id='gs_error_id';var gs_footer_id='gs_footer_id';var gs_header_id='gs_header_id';var gs_body_id='gs_body_id';var gs_ribbon_id='gs_ribbon_id';var gs_main_title_id='main-title';var gs_nav_placeholder_id='gs_nav_placeholder_id';var gs_navbar_id='gs_navbar_id';function getFile(filename,callback,async){var async=typeof async!=='undefined'?async:true;var req=new XMLHttpRequest();req.onreadystatechange=function(){if(req.status==200&&req.readyState==4){callback(req.responseText);}else if(req.status==404){fillDiv('ERROR: 404, File Not Found: "'+filename+'"',gs_error_id);}};req.open('GET',filename,async);req.send();}
function appendAttribute(elem,name,value){var attr=elem.getAttribute(name);if(attr==null){elem.setAttribute(name,value);}else{elem.setAttribute(name,attr+" "+value);}}
function setTitle(title){$('#'+gs_main_title_id).html(title);if(title=='GitStrap'){$('#'+gs_ribbon_id).show()}}
function setTheme(theme){var direct_url=theme;var name_url='https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/'+
theme+'/bootstrap.min.css';var theme_url='';function valid_url(url){return/^(http|https|ftp):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i.test(url);}
if(valid_url(direct_url)){theme_url=direct_url;}
else if(valid_url(name_url)){theme_url=name_url;}
function add_style(url){new_style='<link rel="stylesheet" href="'+url+'" type="text/css" media="screen" />';$('head').append(new_style);}
add_style(theme_url);}
function fillDiv(text,div){var node=document.getElementById(div);node.innerHTML=text;$('#'+div).show();}
function MarkdownToHTML(relpath,markdown_div)
{var callback=function(text){var converter=new showdown.Converter(),html=converter.makeHtml(text);fillDiv(html,markdown_div);};getFile(relpath,callback);}
function PostToHTML(relpath,markdown_body){var callback=function(text){console.log(text);var text=typeof text!=='undefined'?text:null;var body=document.getElementById(markdown_body);var post_head=document.createElement('div');var post_body=document.createElement('div');body.appendChild(post_head);body.appendChild(post_body);if(text==null||text==''||text=='null'){post_head.innerHTML='Unable to load text for: '+relpath;return;}
var obj=jsyaml.loadFront(text)
var date=typeof obj.Date!=='undefined'?obj.Date.toDateString():'';var author=typeof obj.Author!=='undefined'?obj.Author:'';var summary=typeof obj.Summary!=='undefined'?obj.Summary:'';var title=typeof obj.Title!=='undefined'?obj.Title:'';post_head.innerHTML='<b>'+title+'</b><br> &nbsp; &nbsp; '+author+' | <small>'+date+'</small><br><br>';var converter=new showdown.Converter();post_body.innerHTML=converter.makeHtml(obj.__content);};getFile(relpath,callback);}
function Config(filename){var self=this;this.filename=filename
this.title="";this.nav_items=[];this.nav_items_bname=[];this.theme="";this.header="";this.footer="";this.blog_items=[];this.requested_page="";this.post_active=false;this.parseFile=function(text){var options=[];var words=text.split('\n');for(var i=0;i<words.length;i++){if(!(words[i].match(/^#/)||(!words[i]))){if(words[i].match(/^>\S+/)){options.push(words[i].replace(/^>/,''));}}}
self.title=options[0];self.nav_items=options[1].split(' ');self.theme=options[2];self.header=options[3];self.footer=options[4];self.blog_items=options[5].split(' ');self.nav_items_bname=self.nav_items.slice();var blog_index=self.nav_items_bname.indexOf(gs_blog_keyword);self.nav_items_bname[blog_index]=self.blog_items[0];self.determineActivePage();};this.headerIsActive=function(){return self.header!='false';};this.footerIsActive=function(){return self.footer!='false';};this.determineActivePage=function(){var post_found=0;var post_index=-1;var req_post=self.getURLParameter('post');if(!(req_post=='null'||req_post==null)){post_index=self.blog_items.indexOf(req_post);if(post_index>0){post_found=1;}}
var page_found=0;var page_index=-1;var req_page=self.getURLParameter('page');if(!(req_page=='null'||req_page==null)){page_index=self.nav_items_bname.indexOf(req_page);if(page_index>=0){page_found=1;}}
active_page=self.nav_items_bname[0];if(post_found){active_page=self.blog_items[post_index];self.post_active=true;}
if(page_found){active_page=self.nav_items_bname[page_index];self.post_active=false;}
self.requested_page=active_page;};this.getURLParameter=function(name){return decodeURI((RegExp(name+'='+'(.+?)(&|$)').exec(location.search)||[,null])[1]);};this.isBlog=function(){return(self.nav_items.indexOf(gs_blog_keyword)>=0);};this.blogIndexIsActive=function(){if(self.isBlog()){if(self.requested_page==self.blog_items[0]){return true;}}
return false;};this.postIsActive=function(){return self.post_active;};getFile(self.filename,self.parseFile,false);}
function Nav(conf){var self=this;this.conf=conf;this.navbar_obj=document.getElementById(gs_nav_placeholder_id);this.genNavListTags=function(){for(index=0;index<self.conf.nav_items.length;index++){var li=document.createElement('li');var a=document.createElement('a');var item=self.conf.nav_items_bname[index];appendAttribute(a,'class','non-active-nav');if(self.conf.requested_page==item){a.removeAttribute('class');appendAttribute(li,'class','active');}
appendAttribute(li,'id','navitem');appendAttribute(li,'class','nav-item');appendAttribute(a,'class','nav-link');appendAttribute(a,'href','?page='+item+'#');appendAttribute(a,'data-toggle','tab');appendAttribute(a,'style','z-index: 1000;');a.innerHTML=item;li.appendChild(a);self.navbar_obj.appendChild(li);}};this.genNavListTags();}
function BlogIndex(conf){var self=this;this.conf=conf;this.genBlogIndex=function(){var md_body_obj=document.getElementById(gs_body_id);var ul=document.createElement('ul');appendAttribute(ul,'class','list-group');md_body_obj.appendChild(ul);for(index=1;index<self.conf.blog_items.length;index++){var item=self.conf.blog_items[index];var li=document.createElement('li');li.setAttribute('id',item);appendAttribute(li,'class','list-group-item');ul.appendChild(li);self.PostPreviewToHTML(gs_post_path+'/'+item,item);}};this.PostPreviewToHTML=function(relpath,markdown_div){var callback=function(text){console.log(typeof text);var text=typeof text!=='undefined'?text:null;if(text==null||text==''||text=='null'){var li=document.getElementById(markdown_div);li.innerHTML='Unable to load text for: '+relpath;return;}
var obj=jsyaml.loadFront(text)
var date=typeof obj.Date!=='undefined'?obj.Date.toDateString():'';var author=typeof obj.Author!=='undefined'?obj.Author:'';var summary=typeof obj.Summary!=='undefined'?obj.Summary:'';var title=typeof obj.Title!=='undefined'?obj.Title:'';var li=document.getElementById(markdown_div);li.innerHTML='<a href=?post='+markdown_div+'><b>'+title+'</b><br></a> '+author+' | <small>'+
date+'</small><br><i>'+summary+'</i>';};getFile(relpath,callback);};this.genBlogIndex();}
function gitstrap(){var gsConfig=new Config('Config');setTitle(gsConfig.title);setTheme(gsConfig.theme);var gsNav=new Nav(gsConfig);if(gsConfig.headerIsActive()&&!gsConfig.postIsActive()){MarkdownToHTML(gsConfig.header,gs_header_id);}
if(gsConfig.footerIsActive()){MarkdownToHTML(gsConfig.footer,gs_footer_id);}
if(gsConfig.blogIndexIsActive()){var gsBlogIndex=new BlogIndex(gsConfig);}else if(gsConfig.postIsActive()){PostToHTML(gs_post_path+'/'+gsConfig.requested_page,gs_body_id);}else{MarkdownToHTML(gsConfig.requested_page,gs_body_id);}}
$(document).on('shown.bs.tab','a[data-toggle="tab"]',function(e){var href=$(e.target).attr('href');window.location.assign(href);})
$(document).ready(gitstrap);